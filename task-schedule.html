<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf8">
        <title>Project Management / Website Development / Software Development</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf8">
        <meta name="keywords" content="India, Project, Management, Scrum, Master, Agile, Certified, Scrum Master Agile Methodology, Certified Scrum Master">
        <meta name="description" content="Earned Value Analysis Script, Taranjeet Singh Chhabra, Scrum Master, Certified Scrum Master with Experience in Software Development">
        <!-- <meta name="google-site-verification" content="+nxGUDJ4QpAZ5l9Bsjdi102tLVC21AIh5d1Nl23908vVuFHs34="> -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="index, follow">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    </head>
    <body>
        <main>
            <div class="container">
                <table class="table">
                    <thead>
                        <tr>
                            <td>
                                Task
                            </td>
                            <td>
                                Total Time Required
                            </td>
                            <td>
                                Actual Time Spent
                            </td>
                            <td>
                                Percent Complete
                            </td>
                        </tr>
                    </thead>
                    <tbody id="evaData">
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input name="task[]" type="text" />
                            </td>
                            <td>
                                <input name="ttr[]" type="number" />
                            </td>
                            <td>
                                <input name="ats[]" type="number" />
                            </td>
                            <td>
                                <input name="pc[]" type="number" />
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="6">
                                <div class="text-center">
                                    <button class="btn btn-primary" onclick="prepareChart()">Generate Graph</button>
                                </div>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <div class="container">
                <div id="evaOutput" class="mt-5">
                    
                </div>
            </div>
            <div class="container">
                <div class="mt-5">
                    <canvas id="evaChart"></canvas>
                </div>
            </div>
        </main>
        <footer>
            <div class="footer bg-dark text-center text-white p-2 mt-5">
                Copyright &copy 2023 Taranjeet Singh Chhabra. All Rights Reserved. 
            </div>
        </footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script type="text/javascript">
            function prepareChart() {
                let tasks = [];
                let ttr = [];
                let ats = [];
                let pv = [];
                let ppc = [];
                let pc = [];
                let ev = [];
                let sv = [];
                let spi = [];
                let incr = 1;

                let dataSource = document.getElementById('evaData');
                let totalElement = dataSource.childElementCount;

                for (const rowChild of dataSource.children) {
                    for (const dataChild of rowChild.children) {
                        if (dataChild.firstElementChild.name == "task[]") {
                            tasks[incr] = dataChild.firstElementChild.value;
                        } else if (dataChild.firstElementChild.name == "ttr[]") {
                            ttr[incr] = (dataChild.firstElementChild.value != '') ? parseInt(dataChild.firstElementChild.value) : 0;
                        } else if (dataChild.firstElementChild.name == "ats[]") {
                            ats[incr] = (dataChild.firstElementChild.value != '') ? parseInt(dataChild.firstElementChild.value) : 0;
                        } else if (dataChild.firstElementChild.name == "pc[]") {
                            pc[incr] = (dataChild.firstElementChild.value != '') ? parseInt(dataChild.firstElementChild.value) : 0;
                        }
                    }

                    ppc[incr] = ((ats[incr] / ttr[incr]) * 100);

                    if(isNaN(ppc[incr])){
                        ppc[incr]=0;
                    }

                    pv[incr] = (ppc[incr] / 100);
                    
                    if(isNaN(pv[incr])){
                        pv[incr]=0;
                    }

                    ev[incr] = (pc[incr] / 100);
                    
                    if(isNaN(ev[incr])){
                        ev[incr]=0;
                    }

                    sv[incr] = ev[incr] - pv[incr];

                    if(isNaN(sv[incr])){
                        sv[incr]=0;
                    }

                    incr++;
                }

                let evaOutput = document.getElementById('evaOutput');

                incr = 1;

                let table = "<table class='table'>";
                table += "<thead><tr><td>Task</td><td>Planned Value</td><td>Earned Value</td><td>Schedule Variance</td><td>Details</td></tr></thead>";
                table += "<tbody>";
                for (incr = 1; incr <= totalElement; incr++) {
                    let scheduleStatus = "";
                    let costStatus = "";
                    
                    if (sv[incr] < 0) {
                        scheduleStatus = "Task is behind schedule";
                    } else {
                        if(tasks[incr] != '') {
                            scheduleStatus = "Task seems to be following schedule";
                        } else {
                            scheduleStatus = "";
                        }
                    }

                    table+= "<tr><td>" + tasks[incr] + "</td><td>" + ((pv[incr] != 0) ? pv[incr] : '') + "</td><td>" + ((ev[incr] != 0) ? ev[incr] : '') + "</td><td>" + ((sv[incr] != 0) ? sv[incr] : '') + "</td><td>" + ((scheduleStatus != '') ? scheduleStatus : "") + "</td></tr>";
                }
                table += "</tbody>";
                table += "</table>";

                evaOutput.innerHTML = table;
            }
        </script>
    </body>
</html>
